<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>歌手</title>
    <link rel="stylesheet" href="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="css/singer.css">
    <link rel="shortcut icon" type="image/x-icon" href="images/logo1.png">
    <script src="https://cdn.staticfile.org/jquery/2.1.1/jquery.min.js"></script>
    <script src="https://cdn.staticfile.org/twitter-bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="css/index.css">
    <script src="js/common.js"></script>
</head>
<body>
<!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---

                                                      模态框（Modal）

--><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---->
<div class="modal fade" id="myModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true"
     style="overflow: auto;">
    <div class="modal-dialog" style="overflow: auto;">
        <div class="modal-content" style="overflow: auto;">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="false">X</button>
                <h4 class="modal-title" id="myModalLabel">账号密码登录</h4>
            </div>
            <div class="modal-body" style="position: relative;">
                <form id="test" class="form-horizontal" role="form" action="/user/loginPage" method="post"
                      style="padding-left: 50px;">
                    <div class="form-group">
                        <img src="images/logo2.png" style="display: block; padding: 20px 151px">
                        <div class="erweima"><img src="images/QCcode2.png" style="position: absolute;width: 130px;
						height: 130px;bottom: 136px;right: 31px;">
                            <p style="position: absolute;right: 64px;bottom: 106px;">联系我们</p>
                        </div>
                        <label class="col-sm-2 control-label">
                            <span class="glyphicon glyphicon-user">账号</span>
                        </label>
                        <div class="col-sm-10">
                            <input type="text" class="form-control" id="user_name" name="user_name"
                                   placeholder="手机号/QQ号/微信号" style="width: 250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="col-sm-2 control-label">
                            <span class="glyphicon glyphicon-lock">密码</span>
                        </label>
                        <div class="col-sm-10">
                            <input type="password" class="form-control" id="user_password" name="user_password"
                                   placeholder="password" style="width: 250px">
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-10">
                            <div class="checkbox">
                                <label>
                                    <input type="checkbox"> 记住密码
                                </label>
                            </div>
                        </div>
                    </div>
                    <div class="form-group">
                        <div class="modal-footer">
                            <button class="btn btn-primary" data-dismiss="btn btn-default"
                                    style="background-color: #169af3;padding: 5px 30px">登 &nbsp&nbsp&nbsp&nbsp录
                            </button>
                            <a href="/register.html" style="float: left;padding-top: 12px;">没有账号？点此注册</a>
                        </div>
                    </div>
                </form>
            </div>

        </div><!-- /.modal-content -->
    </div><!-- /.modal-dialog -->
</div>
<!-- /.modal -->

<!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---

                                                     首页头部

--><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---->
<div style="width: 100%;height: 80px; background-color:#fff;position: relative;">
    <div style="position: absolute;bottom: -5px;height: 5px;width: 100%;background-color:#fff;z-index: -1;"></div>
    <div class="search1">
        <div class="logo1" style="width: 153px; padding: 20.6px 0; display: inline-block;"><img src="images/logo2.png"
                                                                                                alt=""><a href="#"></a>
        </div>
        <nav class="navmargin navbar navbar-default" role="navigation">
            <div class="shurukuang" style="padding: 20.6px 30px;">
                <form class="bs-example" role="form" action="#" method="get">
                    <div class="row">
                        <div class="col-lg-6">
                            <div class="input-group">
                                <input type="text" id="songName" name="songName" class="form-control"
                                       placeholder="为音乐而生">
                                <span class="input-group-btn">
								 <button onclick="getList2($('#songName').serialize())" class="btn btn-default"
                                         type="button">
									搜索
								</button>
							</span>


                            </div><!-- /input-group -->
                        </div><!-- /.col-lg-6 -->
                        <div id="clock">
                            <p class="date">{{ date }}</p>
                            <p class="time">{{ time }}</p>
                        </div>
                    </div><!-- /.row -->
                </form>
            </div>
            <!-- 图标加上搜索框结束 -->
            <div id="col10" class="dengluzhuce">
                <a class="mymusic" href="/mymusic.html" target="_self" onclick="return isLogin();">我的音乐</a>
                <a class="mymusic" onclick="return isLogin();" href="/mymusic.html" target="_self">您是第<span
                        id="user_number" style="font-size:20px;color:red;text-align:center;padding:0;"> &nbsp</span>位用户</a>
                <span class="mymusic">|</span>
                <img id="touxiang" src="images/touxiang.png" width="40px" height="40px"
                     style="display: inline-block; width: 40px;height: 40px;border:0;border-radius: 40px;margin-bottom: 5px;">
                <a id="userName" style="cursor: pointer;" class="mymusic">
                    未登录</a>
                <a id="zhuXiao" onclick="zhuXiao();location.reload();" href="#">
                </a>
                <button id="display1" class="btn denglu" data-toggle="modal" data-target="#myModal">登 &nbsp&nbsp录
                </button> <!--触发模态框按钮-->
            </div>
        </nav>
    </div>
</div>
<!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---

                                                   下方nav标签导航栏开始）

--><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---->
<nav class="daohanglan">
    <div class="big3">
        <ul>
            <li><a class=" erjicaidan2" href="/index.html">首页</a></li>
            <li><a class=" erjicaidan2" href="/musicRadio.html">电台</a></li>
            <li><a class=" gudingbeij erjicaidan2" href="/singer.html">歌手</a></li>
            <li class="dropdown">
                <a class="erjicaidan2" href="#" class="dropdown-toggle" data-toggle="dropdown">
                    更多 <b class="caret"></b>
                </a>
                <ul class="dropdown-menu">
                    <li><a class="erjicaidan" href="/musicRadio.html">电台</a></li>
                    <li><a class="erjicaidan" href="/singer.html">歌手</a></li>
                </ul>
            </li>
        </ul>
        <ul>
            <li class="youfudong"><a href="/musicSearchTest.html" target="_self"><span
                    class="glyphicon glyphicon-search" style="font-size: 14px"> 搜索</span></a></li>
            <li class="youfudong"><a href="#" target="_blank"><span onclick="playMusic()"
                                                                    class="glyphicon glyphicon-star-empty"
                                                                    style="font-size: 14px"> 在线播放</span></a></li>
        </ul>
    </div>
    </div>
</nav>

<div class="big">
    <div class="l">
        <ul class="sng1">
            <li class="all">
                <span class="content_left_fenlei"><a href="#allSinger" data-toggle="tab">全部歌手</a></span>
            </li>
            <li class="all">
                <span class="content_left_fenlei"><a href="#CNManSinger" data-toggle="tab">华语男歌手</a></span>
            </li>
            <li class="all">
                <span class="content_left_fenlei"><a href="#CNWomanSinger" data-toggle="tab">华语女歌手</a></span>
            </li>
            <li class="all">
                <span class="content_left_fenlei"><a href="#JPManSinger" data-toggle="tab">日本男歌手</a></span>
            </li>
            <li class="all">
                <span class="content_left_fenlei"><a href="#JPWomanSinger" data-toggle="tab">日本女歌手</a></span>
            </li>
            <li class="all">
                <span class="content_left_fenlei"><a href="#EUManSinger" data-toggle="tab">欧美男歌手</a></span>
            </li>
            <li class="all">
                <span class="content_left_fenlei"><a href="#EUWomanSinger" data-toggle="tab">欧美女歌手</a></span>
            </li>
        </ul>
    </div>
    <div class="r">

        <div class="content_right tab-content" style="height:650px; overflow-y: scroll">
            <div class="tab-pane fade in active" id="allSinger">
            </div>
            <div class="tab-pane fade in" id="CNManSinger">
            </div>
            <div class="tab-pane fade in" id="CNWomanSinger">
            </div>
            <div class="tab-pane fade in" id="JPManSinger">
            </div>
            <div class="tab-pane fade in" id="JPWomanSinger">
            </div>
            <div class="tab-pane fade in" id="EUManSinger">
            </div>
            <div class="tab-pane fade in" id="EUWomanSinger">
            </div>

        </div>
    </div>
</div>

<!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---
 
                                                   最后 页脚 

--><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!----><!---->
<div class="footer">
    <div class="links">
        <a hidefocus="true" href="#" target="_blank">开发者：</a>
        <a hidefocus="true" href="#" target="_blank">李欣然</a>
    </div>
    <div class="copyright">
        <p style="-moz-user-select: text;-webkit-user-select: text;-ms-user-select: text; user-select:text">
            如有侵权，请联系：1569641118@qq.com.com </p>
    </div>
</div>
<script src="js/jquery.min.js?v=2.1.4"></script>
<script src="js/bootstrap-paginator.min.js"></script>
<script src="js/jquery.validate.min.js"></script>
<script src="js/tools.js"></script>
<script src="js/jquery.cookie.js"></script>
<script type="text/javascript" src="js/vue.min.js"></script>
<script type="text/javascript">


    if ($.cookie("user_name") != undefined && $.cookie("user_name") != "1") {
        $("#userName").text("账号：" + $.cookie("user_name"));
        $("#zhuXiao").text("注销");


        document.getElementById("touxiang").src = "images/touxiang2.jpg";
        $("#display1").attr("style", "display:none;");
    }

    $('#test').validate({
        errorPlacement: function (error, element) {
            error.appendTo(element.parent());
        },
        onfocusout: function (element) {
            $(element).valid();
        },
        submitHandler: function (form) {
            denglu($('#test').attr("action"), $('#test').serialize());


        }
    });

    function inittabContent(songs) {
        var baseContent = "<div>\n" +
            " #{singer}\n" +
            "</div>\n" +
            "<div class=\"boxbox\">\n" +
            "<table class=\"table\">\n" +
            "<tbody>\n" +
            "#{tr}\n" +
            "</tbody>\n" +
            "</table>\n" +
            "</div>"

        songs = songs.list;
        var divAllSinger = document.getElementById("allSinger");
        var divCNManSinger = document.getElementById("CNManSinger");
        var divCNWomanSinger = document.getElementById("CNWomanSinger");
        var divJPManSinger = document.getElementById("JPManSinger");
        var divJPWomanSinger = document.getElementById("JPWomanSinger");
        var divEUManSinger = document.getElementById("EUManSinger");
        var divEUWomanSinger = document.getElementById("EUWomanSinger");

        var baseAllSinger = baseContent;
        var baseCNManSinger = baseContent;
        var baseCNWomanSinger = baseContent;
        var baseJPManSinger = baseContent;
        var baseJPWomanSinger = baseContent;
        var baseEUManSinger = baseContent;
        var baseEUWomanSinger = baseContent;

        var divSingerAllSinger = ""
        var divSingerCNManSinger = ""
        var divSingerCNWomanSinger = ""
        var divSingerJPManSinger = ""
        var divSingerJPWomanSinger = ""
        var divSingerEUManSinger = ""
        var divSingerEUWomanSinger = ""

        var divSongAllSinger = ""
        var divSongCNManSinger = ""
        var divSongCNWomanSinger = ""
        var divSongJPManSinger = ""
        var divSongJPWomanSinger = ""
        var divSongEUManSinger = ""
        var divSongEUWomanSinger = ""

        var singers = [];
        var numMap = {
            CNMan: 1,
            CNWoman: 1,
            JPMan: 1,
            JPWoman: 1,
            EUMan: 1,
            EUWoman: 1
        };
        for (let i = 0; i < songs.length; i++) {
            var singerName = songs[i].ml_singer;
            var songName = songs[i].ml_songName;
            var songConten = getSongContent(songName, singerName);
            var singerContent = "";
            if (singers.indexOf(singerName) == -1) {
                singers[singers.length] = singerName;
                var singerPhoto = songs[i].singer_photo;
                singerContent = getSingerContent(singerName, singerPhoto);
            }
            var allSongContent = songConten.replace("#{num}", i + 1)
            divSongAllSinger += allSongContent;

            divSingerAllSinger += singerContent;
            switch (songs[i].singer_type) {
                case "华语男":
                    var songCNManContent = songConten.replace("#{num}", numMap.CNMan)
                    numMap.CNMan = numMap.CNMan + 1;
                    divSongCNManSinger += songCNManContent;
                    divSingerCNManSinger += singerContent;
                    break;
                case "华语女":
                    var songCNWomonContent = songConten.replace("#{num}", numMap.CNWoman)
                    numMap.CNWoman = numMap.CNWoman + 1;
                    divSongCNWomanSinger += songCNWomonContent;
                    divSingerCNWomanSinger += singerContent;
                    break;
                case "日语男":
                    var songJPContent = songConten.replace("#{num}", numMap.JPMan)
                    numMap.JPMan = numMap.JPMan + 1;
                    divSongJPManSinger += songJPContent;
                    divSingerJPManSinger += singerContent;
                    break;
                case "日语女":
                    var songJPWomonContent = songConten.replace("#{num}", numMap.JPWoman)
                    numMap.JPWoman = numMap.JPWoman + 1;
                    divSongJPWomanSinger += songJPWomonContent;
                    divSingerJPWomanSinger += singerContent;
                    break;
                case "欧美男":
                    var songEUContent = songConten.replace("#{num}", numMap.EUMan)
                    numMap.EUMan = numMap.EUMan + 1;
                    divSongEUManSinger += songEUContent;
                    divSingerEUManSinger += singerContent;
                    break;
                case "欧美女":
                    var songEUWomonContent = songConten.replace("#{num}", numMap.EUWoman)
                    numMap.EUWoman = numMap.EUWoman + 1;
                    divSongEUWomanSinger += songEUWomonContent;
                    divSingerEUWomanSinger += singerContent;
                    break;
                default:
                    ;
            }
        }
        baseAllSinger = baseAllSinger.replace("#{singer}", divSingerAllSinger);
        baseAllSinger = baseAllSinger.replace("#{tr}", divSongAllSinger);

        baseCNManSinger = baseCNManSinger.replace("#{singer}", divSingerCNManSinger);
        baseCNManSinger = baseCNManSinger.replace("#{tr}", divSongCNManSinger);

        baseCNWomanSinger = baseCNWomanSinger.replace("#{singer}", divSingerCNWomanSinger);
        baseCNWomanSinger = baseCNWomanSinger.replace("#{tr}", divSongCNWomanSinger);

        baseJPManSinger = baseJPManSinger.replace("#{singer}", divSingerJPManSinger);
        baseJPManSinger = baseJPManSinger.replace("#{tr}", divSongJPManSinger);

        baseJPWomanSinger = baseJPWomanSinger.replace("#{singer}", divSingerJPWomanSinger);
        baseJPWomanSinger = baseJPWomanSinger.replace("#{tr}", divSongJPWomanSinger);

        baseEUManSinger = baseEUManSinger.replace("#{singer}", divSingerEUManSinger);
        baseEUManSinger = baseEUManSinger.replace("#{tr}", divSongEUManSinger);

        baseEUWomanSinger = baseEUWomanSinger.replace("#{singer}", divSingerEUWomanSinger);
        baseEUWomanSinger = baseEUWomanSinger.replace("#{tr}", divSongEUWomanSinger);


        divAllSinger.innerHTML = baseAllSinger
        divCNManSinger.innerHTML = baseCNManSinger
        divCNWomanSinger.innerHTML = baseCNWomanSinger
        divJPManSinger.innerHTML = baseJPManSinger
        divJPWomanSinger.innerHTML = baseJPWomanSinger
        divEUManSinger.innerHTML = baseEUManSinger
        divEUWomanSinger.innerHTML = baseEUWomanSinger

    }

    //
    $.ajax({
        url: "musicLink/getSongRearch",
        type: "POST",
        success: function (data) {
            if (data.statusCode == "200") {
                if ($.cookie("user_id")) {
                    $("#user_number").html($.cookie("user_id"));
                } else {
                    var x = 100;
                    var y = 200;
                    var result = Math.floor(Math.random() * (y + 1 - x) + x);
                    $("#user_number").html(result);
                }

                songs = data.data;
                inittabContent(songs);

                function fn(i) {//调用方法，更改cookie的信息，并跳转到播放页面
                    console.log(data.data.list[i].ml_id);
                    $.cookie("song_link", data.data.list[i].ml_songLink, {expires: 7, path: "/"});
                    $.cookie("song_name", data.data.list[i].ml_songName, {expires: 7, path: "/"});
                    $.cookie("song_singer", data.data.list[i].ml_singer, {expires: 7, path: "/"});
                    $.cookie("song_photo", data.data.list[i].ml_photoLink, {expires: 7, path: "/"});
                    window.location.href = "/QQmusic.html";
                }
            }
        },
        error: function (data) {
            alert(JSON.stringify(data));
        }

    })

    function getSingerContent(singerName, imageSrc) {
        var singerContent = "<div class=\"singerpn\">\n" +
            "<a href = \"#\"> <img onclick=\"searchBySinger('#{singerName}')\" src = \"#{imageSrc}\" alt = \"#{singerName}\" class = \"singerpicture\"> </a>\n" +
            "<span class = \"st\"> </span><span class = \"singername\"> #{singerName} </span>\n" +
            "</div>"
        singerContent = singerContent.replace("#{imageSrc}", imageSrc);
        singerContent = singerContent.replace("#{singerName}", singerName);
        singerContent = singerContent.replace("#{singerName}", singerName);
        singerContent = singerContent.replace("#{singerName}", singerName);
        return singerContent;
    }

    function getSongContent(songName, singer) {
        var trContent = "<tr class= \"active\">\n" +
            "<td>#{num} </td>\n" +
            "<td> <a href = \"#\" onclick=\"playMusic('#{songName}')\">#{songName} </a></td>\n" +
            "<td>#{singer} </td>\n" +
            "</tr>"
        trContent = trContent.replace("#{songName}", songName);
        trContent = trContent.replace("#{songName}", songName);
        trContent = trContent.replace("#{singer}", singer);
        return trContent;
    }


    function searchBySinger(singerName) {//调用方法，更改cookie的信息，并跳转到播放页面
        $.ajax({
            url: "musicLink/getSongRearchBySinger",
            type: "POST",
            data: "singerName="+singerName,
            success: function (data) {
                if (data.statusCode == "200") {
                    var search = singerName;
                    $.cookie("singer_search", search, {expires: 7, path: "/"});
                    $.cookie('song_search',null,{ path: '/'});
                    window.location.href="/musicSearchTest.html";
                    var str = '';
                    /* data.data.list.length对应respon.map.list.length */
                    for (var i = 0; i < data.data.list.length; i++) {
                        str += '<tr>'
                            + '<td>' + data.data.list[i].ml_songName + '</td>'
                            + '<td>' + data.data.list[i].ml_singer + '</td>'
                            /* + '<td>' + data.data.list[i].ml_songLink + '</td>' */
                            + '</tr>';
                    }
                    $("table tbody").html(str);
                } else if (data.statusCode == "202") {
                    alert("搜索不到歌曲,请重新输入！");
                }
            },
            error: function (data) {
                alert(JSON.stringify(data));
            }
        })
    }
    /* 音乐搜索 */

    function getList2(lll) {
        $.ajax({
            url: "musicLink/getSongRearch",
            type: "POST",
            data: lll,
            success: function (data) {
                if (data.statusCode == "200") {
                    var search = document.getElementById("songName").value;
                    $.cookie("song_search", search, {expires: 7, path: "/"});
                    window.location.href="/musicSearchTest.html";
                    var str = '';
                    /* data.data.list.length对应respon.map.list.length */
                    for (var i = 0; i < data.data.list.length; i++) {
                        str += '<tr>'
                            + '<td>' + data.data.list[i].ml_songName + '</td>'
                            + '<td>' + data.data.list[i].ml_singer + '</td>'
                            /* + '<td>' + data.data.list[i].ml_songLink + '</td>' */
                            + '</tr>';
                    }
                    $("table tbody").html(str);
                } else if (data.statusCode == "202") {
                    alert("搜索不到歌曲,请重新输入！");
                }
            },
            error: function (data) {
                alert(JSON.stringify(data));
            }
        })
    }//已在mymusic中注释

    //
    //
    //           数字时钟
    //
    //

    var clock = new Vue({
        el: '#clock',
        data: {
            time: '',
            date: ''
        }
    });
    var week = ['星期天', '星期一', '星期二', '星期三', '星期四', '星期五', '星期六'];
    var timerID = setInterval(updateTime, 1000);
    updateTime();

    function updateTime() {
        var cd = new Date();
        clock.time = zeroPadding(cd.getHours(), 2) + ':' + zeroPadding(cd.getMinutes(), 2) + ':' + zeroPadding(cd.getSeconds(), 2);
        clock.date = zeroPadding(cd.getFullYear(), 4) + '-' + zeroPadding(cd.getMonth() + 1, 2) + '-' + zeroPadding(cd.getDate(), 2) + ' ' + week[cd.getDay()];
    };

    function zeroPadding(num, digit) {
        var zero = '';
        for (var i = 0; i < digit; i++) {
            zero += '0';
        }
        return (zero + num).slice(-digit);
    }

</script>
</body>
</html>